# Ê¶ÇË¶Å

„Çπ„Éû„Éº„Éà„Éï„Ç©„É≥„ÅÆÁµµÊñáÂ≠óÈÅ∏Êäû„Ç≠„Éº„Éú„Éº„Éâ„ÅÆ„Çà„ÅÜ„Å™ÁµµÊñáÂ≠óÈÅ∏ÊäûÁîªÈù¢„Çí„ÄÅ„Éñ„É©„Ç¶„Ç∂‰∏ä„ÅßÂÆüÁèæ„Åß„Åç„Çã`emoji-picker-react`„Å®„ÅÑ„ÅÜ„É©„Ç§„Éñ„É©„É™„Å´„Å§„ÅÑ„Å¶„ÄÅÂ∞éÂÖ•ÊñπÊ≥ï„Çí„Åæ„Å®„ÇÅ„Åæ„Åó„Åü„ÄÇ

`emoji-picker-react`„ÅØ„ÄÅÂêçÂâç„ÅÆÈÄö„Çä React Âêë„Åë„ÅÆ„É©„Ç§„Éñ„É©„É™„Å®„Å™„Çä„Åæ„Åô„ÄÇ
Next.js „Å´„ÇÇÂ∞éÂÖ•ÂèØËÉΩ„Åß„Åô„Åå„ÄÅÔºëÁÇπÊ≥®ÊÑè‰∫ãÈ†Ö„Åå„ÅÇ„ÇäÂæåËø∞„Åó„Åæ„Åô„ÄÇ

## „Éá„É¢

![](https://storage.googleapis.com/zenn-user-upload/46485b714378-20220828.gif)

# Â∞éÂÖ•ÊñπÊ≥ï

## „Ç§„É≥„Çπ„Éà„Éº„É´

```
npm i emoji-picker-react
```

## ÊúÄÂ∞èÊßãÊàê„ÅÆ„Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ

```js
import React, { useState } from "react";
import Picker from "emoji-picker-react";

const App = () => {
  const [chosenEmoji, setChosenEmoji] = useState(null);

  const onEmojiClick = (event, emojiObject) => {
    setChosenEmoji(emojiObject);
  };

  return (
    <div>
      {chosenEmoji ? (
        <span>You chose: {chosenEmoji.emoji}</span>
      ) : (
        <span>No emoji Chosen</span>
      )}
      <Picker onEmojiClick={onEmojiClick} />
    </div>
  );
};
```

chosenEmoji „ÅÆ„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆÊßãÈÄ†„ÅØÊ¨°„ÅÆ„Çà„ÅÜ„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ
`emoji`„Ç≠„Éº„Å´„Ç¢„ÇØ„Çª„Çπ„Åô„Çã„Åì„Å®„Åß„ÄÅÈÅ∏Êäû„Åï„Çå„ÅüÁµµÊñáÂ≠ó„ÅÆ String „ÇíÂèñÂæó„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ

```js
{
  activeSkinTone: "neutral",
  emoji: "üôÇ",
  names: ["slightly smiling face", "slightly_smiling_face"],
  originalUnified: "1f642",
  unified: "1f642",
}
```

## „Åù„ÅÆ‰ªñ„Ç™„Éó„Ç∑„Éß„É≥

Picker „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Å´Ë®≠ÂÆöÂèØËÉΩ„Å™„Ç™„Éó„Ç∑„Éß„É≥‰∏ÄË¶ß„ÅØÂÖ¨Âºè„Çµ„Ç§„Éà„Å´Ëºâ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ
`onEmojiClick`‰ª•Â§ñ„ÅØ„ÅÇ„Åæ„Çä‰Ωø„ÅÜ„Åì„Å®„ÅØÁÑ°„ÅÑ„Åã„Å™„Å®ÊÄù„ÅÑ„Åæ„Åó„Åü„ÄÇ
https://www.npmjs.com/package/emoji-picker-react

# Next.js „Å´Â∞éÂÖ•„Åô„ÇãÈöõ„ÅÆÊ≥®ÊÑèÁÇπ

‰∏äË®ò„ÅØ React „Åß„ÅÆ„Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ„Åß„Åô„Åå„ÄÅ„Åù„ÅÆ„Åæ„Åæ Next.js „Å´Â∞éÂÖ•„Åó„Çà„ÅÜ„Å®„Åô„Çã„Å®Ê¨°„ÅÆ„Çà„ÅÜ„Å™„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åô„ÄÇ

```
Server Error
ReferenceError: document is not defined
```

„Å©„ÅÜ„ÇÑ„Çâ„ÄÅ„Åì„ÅÆ„É©„Ç§„Éñ„É©„É™ÂÜÖ„Åß window „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Çí‰ΩøÁî®„Åó„Å¶„ÅÑ„Çã„Çà„ÅÜ„Åß„Åô„Åå„ÄÅwindow „Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅØ„ÇØ„É©„Ç§„Ç¢„É≥„Éà ( „Éñ„É©„Ç¶„Ç∂ ) ÂÅ¥„Åß„Åó„ÅãÂãï‰Ωú„Åó„Å™„ÅÑ„Åü„ÇÅ„ÄÅÂêåÊôÇ„Å´„Çµ„Éº„Éê„ÉºÂÅ¥„Åß„ÇÇ„É¨„É≥„ÉÄ„É™„É≥„Ç∞„ÇíË°å„ÅÜ Next.js „Åß„ÅØ„Åì„Çå„ÇíÂá¶ÁêÜ„Åß„Åç„Å™„ÅÑ„Åì„Å®„ÅåÂéüÂõ†„ÅÆ„Ç®„É©„Éº„Åß„Åô„ÄÇ

„Ç®„É©„Éº„ÅÆÂõûÈÅøÁ≠ñ„Å®„Åó„Å¶„ÄÅ„É©„Ç§„Éñ„É©„É™„ÅÆ„Ç§„É≥„Éù„Éº„ÉàÊñπÊ≥ï„ÇíÊ¨°„ÅÆ„Çà„ÅÜ„Å´Â§âÊõ¥„Åó„Åæ„Åô„ÄÇ

```js
import dynamic from "next/dynamic";
const Picker = dynamic(() => import("emoji-picker-react"), { ssr: false });
```

`Dynamic Import`„Å®„ÅÑ„ÅÜ ES2020 „ÅÆÊ©üËÉΩ„Åå„ÅÇ„Çä„ÄÅNext.js „Åß„ÇÇ„Çµ„Éù„Éº„Éà„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
„Åì„Çå„Å´`{ssr: false}`„Å®„ÅÑ„ÅÜ„Ç™„Éó„Ç∑„Éß„É≥„ÇíË®≠ÂÆö„Åô„Çã„Åì„Å®„Åß„ÄÅNext.js „Åå„Åì„ÅÆ„É¢„Ç∏„É•„Éº„É´„ÅØ SSR „Åó„Å™„ÅÑ„ÇÇ„ÅÆ„Å®Âà§Êñ≠„Åó„ÄÅ„Éñ„É©„Ç¶„Ç∂ÂÅ¥„Å†„Åë„ÅßÂÆüË°å„Åï„Çå„Çã„Åü„ÇÅ„ÄÅ„Ç®„É©„Éº„ÇíÂõûÈÅø„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åô„ÄÇ

:::message
Êú¨Êù•`Dynamic import`„Å®„ÅÑ„ÅÜÊ©üËÉΩ„ÅØ„ÄÅ‰ªªÊÑè„ÅÆ„Çø„Ç§„Éü„É≥„Ç∞„Åß„É¢„Ç∏„É•„Éº„É´„ÇíË™≠„ÅøËæº„ÇÄ„Åì„Å®„Åß„Éö„Éº„Ç∏ÂàùÊúüË°®Á§∫„ÅÆ„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÇíÊîπÂñÑ„Åô„Çã„Åì„Å®„Åå‰∏ª„Å™‰ΩøÁî®ÁõÆÁöÑ„Åß„Åô„Åå„ÄÅ„Åì„ÅÆ„Çà„ÅÜ„Å™Â§â„Çè„Å£„Åü‰Ωø„ÅÑÊñπ„ÅØ Next.js ÁâπÊúâ„Å™„ÇÇ„ÅÆ„Åã„Å®ÊÄù„ÅÑ„Åæ„Åô„ÄÇ
:::

# ÂøúÁî®‰æã

ÁßÅ„ÅÆÂÄã‰∫∫ WEB „Çµ„Ç§„Éà„ÅÆ„Ç≥„É°„É≥„ÉàÊ©üËÉΩ„Å´„ÄÅÁµµÊñáÂ≠ó„Çí„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„Çí„ÅÑ„Çå„Å¶ÊäïÁ®ø„Åô„ÇãÊ©üËÉΩ„ÇíÂÆüË£Ö„Åó„Å¶„Åø„Åæ„Åó„Åü„ÄÇÁµµÊñáÂ≠ó„ÅØ String Âûã„ÅÆ„Åü„ÇÅÊâ±„ÅÑ„ÇÇÈõ£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ

**„Ç≥„É°„É≥„Éà„Å´ÁµµÊñáÂ≠ó„ÅÆ„Ç¢„Ç§„Ç≠„É£„ÉÉ„ÉÅ„Åå„Å§„Åè„Å®„ÄÅ„Å™„Çì„Å†„ÅãÊ•Ω„Åó„ÅÑÈõ∞Âõ≤Ê∞ó„Å´„Å™„Å£„Å¶ËâØ„ÅÑ„Å®ÊÄù„ÅÑ„Åæ„Åó„ÅüÔºÅ**

## Before

![](https://storage.googleapis.com/zenn-user-upload/e5545cc324cf-20220828.png)

## After

![](https://storage.googleapis.com/zenn-user-upload/f349e7a25552-20220828.png)

# „Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ

‰∏äË®òÂøúÁî®‰æã„ÅÆÁµµÊñáÂ≠ó„Éî„ÉÉ„Ç´„ÉºÁÆáÊâÄ„ÇíÊäúÁ≤ã„Åó„Åü Next.js „Åß„ÅÆ„Çµ„É≥„Éó„É´„Ç≥„Éº„Éâ„Åß„Åô„ÄÇ
„Éî„ÉÉ„Ç´„ÉºÁîªÈù¢Â§ñ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„Å®„Åç„Å´„ÄÅ„Éî„ÉÉ„Ç´„ÉºÁîªÈù¢„ÇíÈñâ„Åò„ÇãÂá¶ÁêÜ„ÇíÂÖ•„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ

```js
import { IEmojiData } from "emoji-picker-react";
import dynamic from "next/dynamic";
import { useEffect, useRef, useState } from "react";
const Picker = dynamic(() => import("emoji-picker-react"), { ssr: false });

interface Props_EmojiSelectBox {
  inputHtmlId?: string;
}

const initialEmoji: IEmojiData = {
  activeSkinTone: "neutral",
  emoji: "üôÇ",
  names: ["slightly smiling face", "slightly_smiling_face"],
  originalUnified: "1f642",
  unified: "1f642",
};

const EmojiSelectBox: React.FC<Props_EmojiSelectBox> = (props) => {
  const { inputHtmlId } = props;

  const inputRef = useRef<HTMLDivElement>(null);
  const [showPicker, setShowPicker] = useState(false);
  const [chosenEmoji, setChosenEmoji] = useState<IEmojiData>(initialEmoji);
  const onEmojiClick = (event: React.MouseEvent, emojiObject: IEmojiData) => {
    setChosenEmoji(emojiObject);
  };

  // ÁµµÊñáÂ≠óPicker„ÅÆË°®Á§∫/ÈùûË°®Á§∫„ÅÆ„Ç§„Éô„É≥„Éà„Çí‰ΩúÊàê
  useEffect(() => {
    const el = inputRef.current;

    const hundleClick = (e: MouseEvent) => {
      // ÁµµÊñáÂ≠óPicker„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„ÅüÊôÇ„ÅÆÂá¶ÁêÜ
      if (el?.contains(e.target as Node)) {
        setShowPicker(true);
      }
      // ÁµµÊñáÂ≠óPicker‰ª•Â§ñ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„ÅüÊôÇ„ÅÆÂá¶ÁêÜ
      else {
        setShowPicker(false); // ÁµµÊñáÂ≠óPicker„ÇíÈùûË°®Á§∫Âåñ
      }
    };

    // „Ç¶„Ç§„É≥„Éâ„Ç¶ÂÖ®‰Ωì„ÅÆ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„Çí‰ΩúÊàê
    document.addEventListener("click", hundleClick);

    // „Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„ÅÆ„Ç¢„É≥„Éû„Ç¶„É≥„Éà„ÉªÂÜç„É¨„É≥„ÉÄ„É™„É≥„Ç∞ÊôÇ„Å´„ÄÅ„ÇØ„É™„ÉÉ„ÇØ„Ç§„Éô„É≥„Éà„ÇíÂâäÈô§
    return () => {
      document.removeEventListener("click", hundleClick);
    };
  }, [inputRef]);

  return (
    <>
      <div className="flex flex-wrap -mx-3 mb-4">
        <div className="w-full px-3 relative" ref={inputRef}>
          <label
            className="block tracking-wide text-gray-700 text-xs font-bold mb-2"
            htmlFor={inputHtmlId}
          >
            ÁµµÊñáÂ≠ó
          </label>

          <input
            className={
              "block w-full h-12 text-3xl bg-gray-200 text-gray-700 border rounded px-4 mb-3 focus:outline-none focus:bg-white focus:border-gray-500"
            }
            type="button"
            id={inputHtmlId}
            value={chosenEmoji.emoji}
          />

          <div className={"absolute bottom-16" + (showPicker ? "" : " hidden")}>
            <Picker onEmojiClick={onEmojiClick} />
          </div>
        </div>
      </div>
    </>
  );
};

export default EmojiSelectBox;


```

# ÂèÇËÄÉÊñáÁåÆ

https://www.npmjs.com/package/emoji-picker-react

https://tech.012grp.co.jp/entry/next_dynamicImport
